<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link href="./style.css" rel="stylesheet">
  <title>Web-Usability</title>
</head>

<body class="min-vw-100">
  <div class="modal fade " id="task-stats">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content" style="height:90vh">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Stats</h5>
        </div>
        <div class="modal-body">
          <div class="row">
            <div id="videoPlayer" class="box col-8" style="height:70vh;">

            </div>
            <div class="box col-4" style="height:70vh;">
              <div id="remarks" class="box" style="height:60%;">

              </div>
              <div id="remarks" class="box" style="height:40%;">

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="/docs/5.0/assets/brand/bootstrap-logo.svg" alt="" width="30" height="24"
          class="d-inline-block align-text-top">
        International Institute of Information And Technology, Hyderabad
      </a>
      <div class="navbar-brand d-flex">
        <button class="btn me-2 btn-outline-success" type="submit">Search</button>
        <button class="btn me-2 btn-outline-success" type="submit">Search</button>
      </div>
    </div>
  </nav>
  <div class="modal fade project-register-form" role="dialog" style="height:80vh;top:80px">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <h4>Add a Project</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="registrationDiv">
            <form id="registration-form" request="/register">
              <div class="form-group">
                <label for="name">Project Name:</label>
                <input type="text" class="form-control" id="name" placeholder="Enter your name" name="name">
              </div>
              <div class="form-group">
                <label for="description">Description:</label>
                <input type="description" class="form-control" id="description" placeholder="Brief Description"
                  name="description">
              </div>
              <div class="form-group">
                <label for="url">url:</label>
                <input type="url" class="form-control" id="url" placeholder="Enter Url" name="url">
              </div>
              <hr>
              <button type="submit" class="btn btn-primary me-2">Register</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="contentPanel" class="row justify-content-start">
    <div class="col-4">
      <h3 id="projectName"></h3>
      <div id="projectDetails" class="box col">
        <p id="projectURL" class="col"></p>
        <p id="projectDescription" class="col"></p>
      </div>
      <div id="projectStats" class="box col">
      </div>
    </div>
    <div class="col-8 ">
      <div id="tasks" class="row box px-4 py-4">
        <div class="row justify-content-between">
          <div class="col-3 ">
            <h4>Tests:</h4>
          </div>
        </div>
        <hr>
        <div id="taskList" class="row col-4">

        </div>
      </div>

    </div>

  </div>
  <footer id="footer">
    <div class="container-fluid">
      <div class="row-fluid" style="margin-top: 20px;font-size: 13px;">
        <div class="container">
          <div class="copyright">Â© <span id="copyright-year">2021-2022</span> Software Engineering Research Center
            (SERC), IIIT-Hyderabad.</div>
        </div>
      </div>
    </div>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.6.0.slim.js"
    integrity="sha256-HwWONEZrpuoh951cQD1ov2HUK5zA5DwJ1DNUXaM6FsY=" crossorigin="anonymous"></script>
  <!-- CSS only -->
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script> //$('.carousel').carousel(); 
    var user_email = sessionStorage.getItem('user_email')
    var user_type = sessionStorage.getItem('user_type')
    var server_address = sessionStorage.getItem('server_address')
    var token = sessionStorage.getItem('token')
    var project_id = sessionStorage.getItem('project_id')
    var project_name = sessionStorage.getItem('project_name')
    var task_id = sessionStorage.getItem('task_id')
    var task_name = sessionStorage.getItem('task_name')
    var task_description = sessionStorage.getItem('task_description')
    var task_url = sessionStorage.getItem('task_url')
    url = "";

    url = server_address + "test/";

    url = url + project_id + "/" + task_id;
    async function getResponse(urll) {
      console.log(urll);
      const fetchOptions = {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json",
          "Authorization": "token " + token
        }
      };
      try {
        let response = await fetch(urll, fetchOptions);
        console.log(response);
        return await response.json();
      } catch (err) {
        console.error(err);
      }
    }

    const wraper = async function () {
      const responseTestsList = await getResponse(url);
      const taskInfo = await getResponse(server_address + "task/" + task_id);

      var task_info_object = responseTestsList
      var task_list_object = taskInfo;
      console.log(responseTestsList);
      console.log(taskInfo);

      tmp = '';
      $.each(task_list_object, function (key, value) {
        //console.log(o);
        tmp += '<button class="projectItem card btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#task-stats">';
        tmp += '<h6 class="card-title">' + value.participant_name + '</h6>';
        tmp += '<p class="card-text"><small class="text-muted">' + value.start_time + '</small></p>';
        tmp += '</button>';
      });

      $('#taskList').prepend(tmp);
      $('#projectURL').prepend(task_info_object["URL"]);
      $('#projectDescription').prepend(task_info_object["description"]);
      $('#projectName').prepend(project_name + "/ " + task_name);

    }

    wraper();
    // var responseTestsList ='[{"participant_name":"Spider Man","start_time":"12/11/21, Monday"},{"participant_name":"Bat Man","start_time":"12/11/21, Monday"},{"participant_name":"Super Man","start_time":"12/11/21, Monday"}]'
    // var responseTaskInfo ='[{"URL":"www.iith.ac.in/taskpage", "description":"Perform some task. and work towards work-related goals. Achieve all project goals. "}]'


    //$('#projectOrganization').prepend(task_info_object["organization"]);
  </script>

</body>

</html>